<html>
<head>
<title>Lutz Roeder's Weblog</title>
<link rel='stylesheet' type='text/css' href='../default.css' />
<link rel='alternate' type='application/rss+xml' title='Lutz Roeder' href='rss.xml' />
</head>

<body background='../background.png'>

<br>
<center>

<table cellpadding='0' cellspacing='0' width='600' border='0'>
<tr>
<td valign='top'>
<a href='.'><img src='default.png' border='0'/></a>
</td>
</tr>

<tr>
<td height='12' />
</tr>

<tr>
<td>

<table>
<tr>
<td width='100%' valign='top'>

<br/>

<p>
<img src='0006-0.png' border='0'/><br/><br/>
<img src='0005-0.png' border='0'/><br/><br/>
<img src='0004-0.png' border='0'/><br/><br/>
<img src='0003-0.png' border='0'/><br/><br/>
<img src='0002-0.png' border='0'/><br/><br/>
<img src='0001-0.png' border='0'/><br/><br/>
</p>

</td>

<td width='480' valign='top'>

<table width='470' cellpadding='0' cellspacing='0' style='margin: 0px 0px 0px 0px'>
<%
	XmlDocument document = new XmlDocument();
	document.Load(this.Request.MapPath("rss.xml"));
	
	if (this.Request["PermaLink"] != null)
	{
		foreach (XmlElement channel in document.DocumentElement.GetElementsByTagName("channel"))
		{
			XmlNodeList items = channel.GetElementsByTagName("item");
			
			for (int i = 0; i < items.Count; i++)
			{
				XmlElement item = (XmlElement) items[i];
				XmlNodeList links = item.GetElementsByTagName("link");
				XmlElement link = (XmlElement) links[0];

				if (link.InnerText.EndsWith("?permalink=" + this.Request["PermaLink"]))
				{
					for (int j = i - 1; j >= 0; j--)
					{
						channel.RemoveChild(items[j]);
					}
					
					break;
				}	
			}
		}
	}

	using (StringWriter output = new StringWriter())
	{
		XslTransform transform = new XslTransform();
		transform.Load(this.Request.MapPath("rss.xsl"));
		transform.Transform(document, new XsltArgumentList(), output);

		this.Response.Write(output.ToString());
	}
%>
</table>

<hr size='1' color='#8c8c8c'>
<i>These postings are provided "AS IS" with no warranties, and confer no rights.</i>

</td>
</table>

</center>
</body>
</html>
